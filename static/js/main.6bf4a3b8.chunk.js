(this.webpackJsonppinn=this.webpackJsonppinn||[]).push([[0],{22:function(e,t,a){e.exports=a(20).wrap(a(34)()),e.exports.__esModule=!0},23:function(e,t,a){e.exports={"image-input":"image-input_image-input__1ZpqQ",imageInput:"image-input_image-input__1ZpqQ","file-input":"image-input_file-input__O7iAO",fileInput:"image-input_file-input__O7iAO",trigger:"image-input_trigger__1Ov2N"}},27:function(e,t,a){},3:function(e,t,a){e.exports={"image-handler-container":"image-handler_image-handler-container__2LVQd",imageHandlerContainer:"image-handler_image-handler-container__2LVQd","ctl-group":"image-handler_ctl-group__2Hncg",ctlGroup:"image-handler_ctl-group__2Hncg","select-handler":"image-handler_select-handler__3EKfk",selectHandler:"image-handler_select-handler__3EKfk","overlay-indicator":"image-handler_overlay-indicator__1IGeu",overlayIndicator:"image-handler_overlay-indicator__1IGeu"}},34:function(e,t,a){e.exports=function(){return new Worker(a.p+"c4638173e2d95ea8dcdc.worker.js")}},38:function(e,t,a){"use strict";a.r(t);a(27);var n=a(1),r=a.n(n),i=a(24),o=a.n(i),c=a(17),s=a(5),l=a(6),p=a.n(l),u=a(16),f=a(2),d=a(10),g=a(11),m=a(12),h=a(13),b=a(8),v=a.n(b),j=a(20),_=a(25),O=a(14),w=a.n(O),x=a(40),I=function(e){var t=e.map((function(e){return window.createImageBitmap(e.imgRef)}));return Promise.all(t).then((function(t){return[t,e.map((function(e){var t=e.imgRef,a=e.topPos,n=e.selectH,r=e.offsetHeight,i=t.naturalHeight/r*a,o=t.naturalHeight/r*n;return{realSy:parseInt(i,10),realSh:parseInt(o,10)}}))]}))},R=function(e,t){for(var a=e.querySelector(t);a;)e.removeChild(a),a=e.querySelector(t)},y=a(22),P=a(23),D=a.n(P),S=a(39),k=a(0),C=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).inputRef=r.a.createRef(),e.state={files:[],previewUrls:[]},e.handleImageChosen=function(t){var a=t.target.files;e.props.onSelectImages(a.length||0);var n=Array.from(a).map((function(e){return window.URL.createObjectURL(e)}));e.setState({files:n}),e.props.onFilesReady(n)},e}return Object(g.a)(a,[{key:"render",value:function(){return Object(k.jsxs)("div",{className:D.a.imageInput,children:[Object(k.jsx)("input",{type:"file",accept:"image/*",multiple:"multiple",id:"file-input",className:D.a.fileInput,ref:this.inputRef,onChange:this.handleImageChosen}),Object(k.jsx)(S.a,{color:"#18BA88",size:"2.6rem"}),Object(k.jsx)("label",{htmlFor:"file-input",children:"Choose file(s)"})]})}}]),a}(r.a.Component),H=a(7),N=a(3),L=a.n(N),A=20,U=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).topRef=null,e.botRef=null,e.containerRef=null,e.imgRef=null,e.state={topPos:e.props.topPos||100,botPos:e.props.botPos||20,containerHeight:"unset",locked:!!e.props.forceLocked},e.generateCropped=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=e.containerRef.offsetHeight,n=e.state,r=n.topPos,i=n.botPos,o=a-r-i;e.props.onCollectImageData(e.imgRef,r,o,a,e.props.imageIdx,t)},e.onImgLoad=function(){e.props.onImageLoad(e.imgRef);var t=e.imgRef,a=t.naturalHeight/t.naturalWidth*500,n=!e.props.topPos,r={containerHeight:"".concat(a,"px")};if(n){var i=e.state.botPos;r.topPos=a-i-100}e.setState(Object(c.a)({},r),(function(){e.generateCropped()}))},e.updateState=function(t){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=e.containerRef.offsetHeight,i=e.state,o=i.topPos,c=i.botPos,s=t,l=r-c-s;a||(l=r-s-o),l<A&&(s=r-c-A,a||(s=r-o-A));var p=a?"topPos":"botPos";e.setState(Object(H.a)({},p,s),(function(){n&&n()}))},e.handleDragStart=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(a){var n=e.containerRef,r=n.offsetTop,i=n.offsetHeight,o=a.pageY,c=o-r;t||(c=i+r-o),e.updateState(c,t)}},e.handleDrop=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(a){var n=e.containerRef,r=n.offsetTop,i=n.offsetHeight,o=a.pageY-r;t||(o=i-o),o<0&&(o=0),e.updateState(o,t,(function(){return e.generateCropped(!0)}))}},e.getRef=function(t){return function(a){e[t]=a}},e}return Object(g.a)(a,[{key:"render",value:function(){var e=this.props.imageSrc,t=this.state,a=t.topPos,n=t.botPos,r=t.containerHeight;return Object(k.jsxs)("div",{className:L.a.imageHandlerContainer,style:{width:"".concat(500,"px"),height:r},ref:this.getRef("containerRef"),children:[Object(k.jsx)("div",{className:L.a.ctlGroup,children:Object(k.jsx)("span",{className:w()("icon",L.a.removeImg),children:Object(k.jsx)("i",{className:"ion ion-md-close",onClick:this.props.onRemoveImage})})}),Object(k.jsx)("img",{className:L.a.imgContainer,alt:"",draggable:!1,src:e,ref:this.getRef("imgRef"),onLoad:this.onImgLoad}),Object(k.jsx)("div",{className:L.a.overlayIndicator,style:{top:0,height:"".concat(a,"px")}}),Object(k.jsx)("div",{className:w()(L.a.selectHandler,L.a.top),style:{top:"".concat(a,"px")},ref:this.getRef("topRef"),draggable:!0,onDrag:this.handleDragStart(),onDragEnd:this.handleDrop()}),Object(k.jsx)("div",{className:w()(L.a.selectHandler,L.a.bottom),style:{bottom:"".concat(n,"px")},ref:this.getRef("botRef"),draggable:!0,onDrag:this.handleDragStart(!1),onDragEnd:this.handleDrop(!1)}),Object(k.jsx)("div",{className:L.a.overlayIndicator,style:{bottom:0,height:"".concat(n,"px")}})]})}}]),a}(r.a.Component),B=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={previewUrls:[],imageData:[],files:[],canDownload:!1},e.selectImages=function(t){e.setState((function(e){return{imageData:[].concat(Object(f.a)(e.imageData),Object(f.a)(Array(t).fill(null)))}}))},e.handleFiles=function(t){e.setState((function(e){return{files:e.files.concat(t)}}))},e.removeImg=function(t){return Object(u.a)(p.a.mark((function a(){var n,r,i,o,c;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.state,r=n.previewUrls,i=n.imageData,o=n.files,c=[].concat(Object(f.a)(i.slice(0,t)),Object(f.a)(i.slice(t+1))),e.setState({files:[].concat(Object(f.a)(o.slice(0,t)),Object(f.a)(o.slice(t+1))),previewUrls:[].concat(Object(f.a)(r.slice(0,t)),Object(f.a)(r.slice(t+1))),imageData:c}),a.next=5,e.drawPreview(c);case 5:case"end":return a.stop()}}),a)})))},e.generateImg=Object(u.a)(p.a.mark((function t(){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.drawPreview(e.state.imageData);case 2:case"end":return t.stop()}}),t)}))),e.download=function(){var t=Object(u.a)(p.a.mark((function t(a){var n,r,i,o,c;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,I(e.state.imageData);case 3:return n=t.sent,r=Object(s.a)(n,2),i=r[0],o=r[1],t.next=9,Object(y.downloadImage)(j.transfer({bitmaps:i,data:o},i));case 9:return c=t.sent,t.next=12,Object(_.saveAs)(c,"pinn-image.png");case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.drawPreview=function(){var t=Object(u.a)(p.a.mark((function t(a){var n,r,i,o,c,l,u;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I(a);case 2:return n=t.sent,r=Object(s.a)(n,2),i=r[0],o=r[1],300,c=document.querySelector("#final-preview"),R(c,"CANVAS"),l=document.createElement("canvas"),c.appendChild(l),u=l.transferControlToOffscreen(),t.next=14,Object(y.drawOffscreenCanvas)(j.transfer({data:o,bitmaps:i,dw:300,offscreen:u},[].concat(Object(f.a)(i),[u])));case 14:e.setState({canDownload:!0});case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.collectImageData=function(t,a,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=e.state.imageData,s=[].concat(Object(f.a)(c.slice(0,i)),[{imgRef:t,topPos:a,selectH:n,offsetHeight:r,imageIdx:i}],Object(f.a)(c.slice(i+1)));e.setState({imageData:s});var l=s.every(Boolean)||o;l&&e.drawPreview(s)},e.onImageLoad=function(e){return function(){window.URL.revokeObjectURL(e)}},e.renderImgHandler=function(t,a){var n={};return a||(n={topPos:1,botPos:1,forceLocked:!0}),Object(k.jsx)(U,Object(c.a)({imageIdx:a,imageSrc:t,onRemoveImage:e.removeImg(a),onCollectImageData:e.collectImageData,onImageLoad:e.onImageLoad(t)},n),"img-".concat(t))},e}return Object(g.a)(a,[{key:"render",value:function(){var e=this.state,t=e.files,a=e.canDownload;return Object(k.jsxs)("div",{className:v.a.app,children:[Object(k.jsx)(C,{onFilesReady:this.handleFiles,onSelectImages:this.selectImages}),Object(k.jsx)("div",{className:v.a.btnGroup,children:Object(k.jsx)("a",{href:"#pinn-btn",className:w()("button is-link is-light",v.a.pinnBtn),onClick:this.generateImg,children:"Pinn!"})}),Object(k.jsxs)("div",{className:v.a.selectedPics,children:[Object(k.jsx)("div",{className:v.a.fileList,children:t.length>0&&t.map(this.renderImgHandler)}),Object(k.jsx)("div",{id:"final-preview",className:v.a.finalPreview,children:a&&Object(k.jsx)("div",{className:v.a.download,children:Object(k.jsx)(x.a,{color:"#fd0f5e",size:"5rem",onClick:this.download})})})]})]})}}]),a}(n.Component);o.a.render(Object(k.jsx)(B,{}),document.getElementById("root"))},8:function(e,t,a){e.exports={app:"app_app__3mk8F","selected-pics":"app_selected-pics__3hYXn",selectedPics:"app_selected-pics__3hYXn","file-list":"app_file-list__3Ve_J",fileList:"app_file-list__3Ve_J",preview:"app_preview__3Z6mu",btn:"app_btn__1lQJS","btn-group":"app_btn-group__3gpA1",btnGroup:"app_btn-group__3gpA1",finalPreview:"app_finalPreview__1ep57",download:"app_download__khK-j","pinn-btn":"app_pinn-btn__1WLIM",pinnBtn:"app_pinn-btn__1WLIM"}}},[[38,1,2]]]);
//# sourceMappingURL=main.6bf4a3b8.chunk.js.map